<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core">

<h:form id="handlePersonForm">

<p:outputPanel id="handlePanel" >
<table border="0" cellpadding="3" cellspacing="3" class="panelLikeTable">

<tr valign="top">
<td>
<p:tabView id="tabPanel">

<p:tab title="Person">

        <table border="0" cellpadding="3" cellspacing="3" width="360"
               dir="#{me.direction}">


            <tr valign="top">
                <td>
                    <table border="0" cellpadding="3" cellspacing="3"
                           align="#{me.align}">


                        <tr valign="top">
                            <td nowrap="nowrap">
                                <h:outputText escape="true"
                                        value="firstname:"
                                        styleClass="textColor"/>
                            </td>
                            <td nowrap="nowrap">
                                <h:inputText dir="#{me.direction}"
                                             id="firstname"
                                             converter="persianConverter"
                                             value="#{handlePersonAction.personname}"
                                             maxlength="25"
                                             required="true"
                                             styleClass="inputRequiredField"/>
                                <p:message ajaxRendered="true" for="firstname" showSummary="true" showDetail="false"
                                              errorClass="errorMsg"/>
                            </td>

                            <td nowrap="nowrap">
                                <h:outputText escape="true"
                                        value="lastname:"
                                        styleClass="textColor"/>
                            </td>
                            <td nowrap="nowrap">
                                <h:inputText dir="#{me.direction}"
                                             id="lastname"
                                             converter="persianConverter"
                                             required="true"
                                             value="#{handlePersonAction.lastname}"
                                             maxlength="25"
                                             styleClass="inputRequiredField"/>
                                <p:message ajaxRendered="true" for="lastname" showSummary="true" showDetail="false"
                                              errorClass="errorMsg"/>
                            </td>
                        </tr>
                        <tr valign="top">
                            <td nowrap="nowrap">
                                <h:outputText escape="true"
                                        value="email:"
                                        styleClass="textColor"/>
                            </td>
                            <td nowrap="nowrap">
                                <h:inputText dir="#{me.direction}"
                                             id="email"
                                             value="#{handlePersonAction.email}"
                                             maxlength="25"/>
                                <p:message ajaxRendered="true" for="email" showSummary="true"
                                              showDetail="false" errorClass="errorMsg"/>
                            </td>
                            <td nowrap="nowrap">
                                <h:outputText escape="true"
                                        value="mobile:"
                                        styleClass="textColor"/>
                            </td>
                            <td nowrap="nowrap">
                                <h:inputText dir="#{me.direction}"
                                             id="mobile"
                                             value="#{handlePersonAction.mobile}"
                                             maxlength="25"/>
                            </td>
                        </tr>

                        <tr>
                            <td nowrap="nowrap">
                                <h:outputText escape="true"
                                        value="personnelCode:"
                                        styleClass="textColor"/>
                            </td>
                            <td nowrap="nowrap">
                                <h:inputText dir="#{me.direction}"
                                             id="_personnelCode"
                                             required="true"
                                             value="#{handlePersonAction.personnelNo}"
                                             maxlength="25"
                                             styleClass="inputRequiredField"/>
                                <p:message ajaxRendered="true" for="_personnelCode" showSummary="true"
                                              showDetail="false" errorClass="errorMsg"/>
                            </td>
                            <td nowrap="nowrap">
                                <h:outputText escape="true"
                                        value="nationalCode:"
                                        styleClass="textColor"/>
                            </td>
                            <td nowrap="nowrap">
                                <h:inputText dir="#{me.direction}"
                                             id="_nationalCode"
                                             required="true"
                                             value="#{handlePersonAction.nationalCode}"
                                             maxlength="25"
                                             styleClass="inputRequiredField"/>
                                <p:message ajaxRendered="true" for="_nationalCode" showSummary="true"
                                              showDetail="false" errorClass="errorMsg"/>
                            </td>
                        </tr>
                        <tr>
                            <td nowrap="nowrap">
                                <h:outputText escape="true"
                                        rendered="#{not handlePersonAction.editable}"
                                        value="password:"
                                        styleClass="textColor"/>
                            </td>
                            <td nowrap="nowrap">
                                <h:inputSecret dir="#{me.direction}"
                                               rendered="#{not handlePersonAction.editable}"
                                               id="_personnelPassword"
                                               value="#{handlePersonAction.password}"
                                               maxlength="25"/>
                            </td>
                            <td nowrap="nowrap">
                                <h:outputText escape="true"
                                        rendered="#{not handlePersonAction.editable}"
                                        value="confirm-password:"
                                        styleClass="textColor"/>
                            </td>
                            <td nowrap="nowrap">
                                <h:inputSecret dir="#{me.direction}"
                                               rendered="#{not handlePersonAction.editable}"
                                               id="_personnelConfirm-password"
                                               value="#{handlePersonAction.rePassword}"
                                               maxlength="25"/>
                            </td>

                        </tr>
                        <tr valign="top">
                            <td nowrap="nowrap">
                                <h:outputText escape="true"
                                        value="address:"
                                        styleClass="textColor"/>
                            </td>
                            <td nowrap="nowrap">
                                <h:inputTextarea dir="#{me.direction}"
                                                 id="address"
                                                 value="#{handlePersonAction.address}"
                                                 maxlength="25"/>
                            </td>
                            <td nowrap="nowrap">
                                <h:outputText escape="true"
                                        value="workStation:"
                                        styleClass="textColor"/>
                            </td>
                            <td nowrap="nowrap">
                                <h:inputText dir="#{me.direction}"
                                             id="_workStation"
                                             value="#{handlePersonAction.workStation}"
                                             maxlength="25"/>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
</p:tab>

<p:tab title="Job">

        <table border="0" cellpadding="3" cellspacing="3" width="360" dir="#{me.direction}">

            <tr>
                <td nowrap="nowrap">
                    <table border="0" cellpadding="3" cellspacing="3"
                           align="#{me.align}">
                        <tr valign="top">
                            <td nowrap="nowrap">
                                <h:outputText escape="true"
                                        value="employeeNo:" styleClass="textColor"/>
                            </td>
                            <td nowrap="nowrap">
                                <h:inputText dir="#{me.direction}"
                                             id="employeeNo"
                                             value="#{handlePersonAction.employNo}"
                                             maxlength="25"/>
                            </td>
                            <td nowrap="nowrap">
                                <h:outputText escape="true"
                                        value="employeeType:"
                                        styleClass="textColor"/>
                            </td>
                            <td nowrap="nowrap" align="#{me.align}">
                                <h:selectOneMenu value="#{handlePersonAction.employeeType.id}"
                                                 valueChangeListener="#{handlePersonAction.selectEmployType}">
                                    <f:selectItems itemLabel="#{employeeType.code}"
                                                   itemValue="#{employeeType.id}" var="employeeType"
                                                   value="#{handlePersonAction.employeeTypes}"/>
                                </h:selectOneMenu>
                            </td>

                        </tr>
                        <tr valign="top">
                            <td nowrap="nowrap">
                                <h:outputText escape="true" value="folderNo:" styleClass="textColor"/>
                            </td>
                            <td nowrap="nowrap">
                                <h:inputText dir="#{me.direction}"
                                             id="folderNo"
                                             value="#{handlePersonAction.folderNo}"
                                             maxlength="25"/>
                            </td>
                            <td nowrap="nowrap">
                                <h:outputText escape="true"
                                        value="intenalTel:" styleClass="textColor"/>
                            </td>
                            <td nowrap="nowrap">
                                <h:inputText dir="#{me.direction}"
                                             id="intenalTel"
                                             value="#{handlePersonAction.internalTel}"
                                             maxlength="25"/>
                            </td>


                        </tr>
                        <tr valign="top">
                            <td nowrap="nowrap">
                                <h:outputText escape="true"
                                        value="post:"
                                        styleClass="textColor"/>
                            </td>
                            <td nowrap="nowrap" align="#{me.align}">
                                <h:selectOneMenu value="#{handlePersonAction.postType.id}"
                                                 valueChangeListener="#{handlePersonAction.selectPostType}">
                                    <f:selectItems itemLabel="#{postType.code}"
                                                   itemValue="#{postType.id}" var="postType"
                                                   value="#{handlePersonAction.postTypes}"/>
                                </h:selectOneMenu>
                            </td>
                            <td nowrap="nowrap">
                                <h:outputText escape="true" value="assistType:"
                                              styleClass="textColor"/>
                            </td>
                            <td nowrap="nowrap" align="#{me.align}">
                                <h:selectOneMenu value="#{handlePersonAction.assistType.id}"
                                                 valueChangeListener="#{handlePersonAction.selectAssistType}">
                                    <f:selectItems itemLabel="#{assistType.code}"
                                                   itemValue="#{assistType.id}" var="assistType"
                                                   value="#{handlePersonAction.assistTypes}"/>
                                </h:selectOneMenu>
                            </td>

                        </tr>
                        <tr valign="top">
                            <td nowrap="nowrap">
                                <h:outputText escape="true"
                                        value="description:" styleClass="textColor"/>
                            </td>
                            <td nowrap="nowrap">
                                <h:inputTextarea dir="#{me.direction}"
                                                 id="description"
                                                 value="#{handlePersonAction.description}"
                                                 maxlength="100"/>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
</p:tab>

<p:tab title="Organ">
        <table border="0" cellpadding="3" cellspacing="3" width="360" dir="#{me.direction}">
            <tr valign="top">
                <td nowrap="nowrap">
                    <h:outputText escape="true" id="organName"
                                  value="#{handlePersonAction.selectedOrganName}:"
                                  styleClass="textColor"/>
                </td>
            </tr>
            <tr>
                <td>
                    <div align="right">
                        <ui:repeat value="#{handleOrganAction.rootOrgans}" var="organs"/>
                        <p:tree id="tree" var="organ" dir="RTL" value="#{organs}"
                                   toggleType="client">
                            <p:treeNode iconCollapsed="/images/node_icon.gif" iconExpanded="/images/node_open.jpg">
                                <p:commandLink
                                        value="#{organ.name} - #{organ.code} - #{organ.organType.code} - #{organ.title}"
                                        execute="@this"
                                        limitRender="true"
                                        update="organName"
                                        action="#{handlePersonAction.selectOrgan(organ.id)}"/>
                            </p:treeNode>
                        </p:tree>
                    </div>
                </td>
            </tr>
        </table>
</p:tab>

<p:tab header="picture">

        <table border="0" cellpadding="3" cellspacing="3" width="360" dir="#{me.direction}">
            <tr>
                <td dir="ltr">
                    <p:fileUpload id="upload"
                                     fileUploadListener="#{handlePersonAction.listener}"
                                     maxFilesQuantity="1"
                                     update="personPicture"
                                     sizeExceededLabel="30"
                                     acceptedTypes="png,jpg,bmp"
                                     style="width:395px "
                                     execute="@this"
                                     limitRender="true"
                                     immediateUpload="true"
                                     listHeight="60px"
                                     addLabel="#{empty handlePersonAction.currentPerson.picture ?'add' : 'edit'} "
                                     doneLabel="done"
                                     clearAllLabel="delete-picture"
                                     clearLabel="delete-picture"
                                     deleteLabel="delete-picture"
                                     ontyperejected="alert('file_type_is_incorrect')"
                                     onfileselect="removeLastUploadedFiles(this)"/>

                </td>
                <td>
                    <p:graphicImage id="personPicture"
                                     value="/loadImage?id=#{handlePersonAction.currentPerson.id}"
                                     style="display:block;height: 150px">
                        <f:param value="#{handlePersonAction.time}" name="time"/>
                    </p:graphicImage>
                    <br/>
                    <p:commandLink value="delete-picture"
                                     rendered="#{handlePersonAction.havePicture and handlePersonAction.editable}"
                                     action="#{handlePersonAction.deletePicture}"
                                     update="personPicture"/>
                </td>
                <td>
                    <p:commandButton value="unload" rendered="false"
                                       action="#{handlePersonAction.unsetPicture}"
                                       update="handlePanel"/>
                </td>
            </tr>
        </table>
</p:tab>

<p:tab header="extraFeild">

        <table border="0" cellpadding="3" cellspacing="3" width="360" dir="#{me.direction}">
            <tr valign="top">
                <td nowrap="nowrap">
                    <h:outputText escape="true" rendered="#{handlePersonAction.extraField1Enable}"
                                  value="#{me.generalHelper.personExtraField1}:"
                                  styleClass="textColor"/>
                </td>
                <td nowrap="nowrap">
                    <h:inputText dir="#{me.direction}"
                                 id="extrafiled1"
                                 value="#{handlePersonAction.extraField1}"
                                 maxlength="25"
                                 rendered="#{handlePersonAction.extraField1Enable}"
                                 disabled="#{handlePersonAction.editable}"/>
                </td>
                <td nowrap="nowrap">
                    <h:outputText escape="true" rendered="#{handlePersonAction.extraField2Enable}"
                                  value="#{me.generalHelper.personExtraField2}:"
                                  styleClass="textColor"/>
                </td>
                <td nowrap="nowrap">
                    <h:inputText dir="#{me.direction}"
                                 id="extrafiled2"
                                 value="#{handlePersonAction.extraField2}"
                                 maxlength="25"
                                 rendered="#{handlePersonAction.extraField2Enable}"
                                 disabled="#{handlePersonAction.editable}"/>
                </td>
            </tr>
            <tr valign="top">

                <td nowrap="nowrap">
                    <h:outputText escape="true" rendered="#{handlePersonAction.extraField3Enable}"
                                  value="#{me.generalHelper.personExtraField3}:"
                                  styleClass="textColor"/>
                </td>
                <td nowrap="nowrap">
                    <h:inputText dir="#{me.direction}"
                                 id="extrafiled3"
                                 value="#{handlePersonAction.extraField3}"
                                 maxlength="25"
                                 rendered="#{handlePersonAction.extraField3Enable}"
                                 disabled="#{handlePersonAction.editable}"/>
                </td>
                <td nowrap="nowrap">
                    <h:outputText escape="true" rendered="#{handlePersonAction.extraField4Enable}"
                                  value="#{me.generalHelper.personExtraField4}:"
                                  styleClass="textColor"/>
                </td>
                <td nowrap="nowrap">
                    <h:inputText dir="#{me.direction}"
                                 id="extrafiled4"
                                 rendered="#{handlePersonAction.extraField4Enable}"
                                 value="#{handlePersonAction.extraField4}"
                                 maxlength="25"
                                 disabled="#{handlePersonAction.editable}"/>
                </td>
            </tr>
        </table>
</p:tab>

<p:tab header="cards" rendered="#{handlePersonAction.editable eq 'true'}">
    <table border="0" cellpadding="3" cellspacing="3" align="#{me.align}">
        <tr valign="top">
            <td nowrap="nowrap">
                <h:outputText escape="true" value="finger:" styleClass="textColor"/>
            </td>
            <td nowrap="nowrap">
                <h:graphicImage
                        value="#{handlePersonAction.finger eq 'true' ? '/images/s_true.png':'/images/s_false.png'}"/>
            </td>
        </tr>
        <ui:repeat value="#{handlePersonAction.cards}" var="card">
            <tr valign="top">
                <td nowrap="nowrap" colspan="2">
                        <table border="0" cellpadding="3" cellspacing="3"
                               align="#{me.align}">


                            <tr valign="top">
                                <td nowrap="nowrap">
                                    <h:outputText escape="true" value="card:"
                                                  styleClass="textColor"/>
                                </td>
                                <td nowrap="nowrap">
                                    <h:outputText escape="true" dir="#{me.direction}"
                                                  id="card"
                                                  value="#{card.code}"
                                                  maxlength="25"
                                                  styleClass="textColor"/>
                                </td>

                            </tr>
                            <tr valign="top">
                                <td nowrap="nowrap">
                                    <h:outputText escape="true" value="card_status" styleClass="textColor"/>
                                </td>
                                <td nowrap="nowrap">
                                    <h:outputText escape="true" value="#{me.getValue(card.cardStatus.code)}" styleClass="textColor"/>
                                </td>
                                <td nowrap="nowrap">
                                    <h:outputText escape="true" value="card_type" styleClass="textColor"/>
                                </td>
                                <td nowrap="nowrap">
                                    <h:outputText escape="true" value="#{me.getValue(card.cardType.code)}" styleClass="textColor"/>
                                </td>
                            </tr>
                            <tr valign="top">
                                <td nowrap="nowrap">
                                    <h:outputText escape="true" value="startDate" styleClass="textColor"/>
                                </td>
                                <td nowrap="nowrap">
                                    <h:outputText escape="true" value="#{card.startDate}" converter="dateConverter"
                                                  styleClass="textColor"/>
                                </td>
                                <td nowrap="nowrap">
                                    <h:outputText escape="true" value="expirationDate" styleClass="textColor"/>
                                </td>
                                <td nowrap="nowrap">
                                    <h:outputText escape="true" value="#{card.expirationDate}"
                                                  converter="dateConverter" styleClass="textColor"/>
                                </td>
                            </tr>
                        </table>
                </td>
            </tr>
        </ui:repeat>
    </table>
</p:tab>
</p:tabView>
</td>
</tr>
<tr valign="top">
    <td nowrap="nowrap" colspan="4">
        <p:commandButton id="saveId"
                           value="save"
                           action="#{handlePersonAction.saveOrUpdate}"/>
        <h:commandButton id="resetId"
                         rendered="#{handlePersonAction.enabled eq 'true'}"
                         action="#{handlePersonAction.begin}"
                         value="#{bundle.revert}"/>


    </td>
</tr>
</table>
</p:outputPanel>
</h:form>

</ui:composition>



